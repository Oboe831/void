<div class="overview">
	<div class="banner">
		<div>
			<label>Player Name:<input type="text" name="attr_player_name" value=" " style="width: 50px;"/></label>
			<label>Race:
				<select name="attr_race">
					<option value="Human">Human</option>
					<option value="Dwarf">Dwarf</option>
					<option value="Elf">Elf</option>
					<option value="Jaraquenai">Jara'quenai Lyth</option>
					<option value="Jaramenat">Jara'menat Lyth</option>
					<option value="Vermere">Vermere</option>
					<option value="Rendara">Rendara</option>
					<option value="Algorian">Algorian</option>
					<option value="Cthonian">Cthonian</option>
				</select>
			</label>
		</div>
		<div>
			<label>Veterancy (VP): <input type="number" name="attr_veterancy" value="0" /></label>
			<label>Background:
				<select name="attr_background">
					<option value="actor">Actor</option>
					<option value="kayn" selected="selected">Kayn</option>
				</select>
			</label>
			
		</div>
		
	</div>

	<input type="hidden" class="sheet-tabstoggle" name="attr_sheetTab" value="attributes">
	<div>
		<button type="action" name="act_attributes">Attributes</button>
		<button type="action" name="act_inventory">Gear</button>
		<button type="action" name="act_attacks">Attacks</button>
	</div>
	<div class="attributes">
		<div class="attributes-main">
			<div class="bad">
				<div class="attribute">
					<h2>Brawn: <input type="number" name="attr_brawn" value="0" /></h2>
					<div class="skills">
						<!--fuck js-->
						<label>Climbing <input type="checkbox" name="attr_climbing_rank_1"> <input type="checkbox" name="attr_climbing_rank_2"> <input type="hidden" name="attr_climbing_mod" value="0"> <button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{climbing_mod})d6>?{Target DC|2}"></button></label>
						<label>Endurance <input type="checkbox" name="attr_endurance_rank_1"> <input type="checkbox" name="attr_endurance _rank_2"> <input type="hidden" name="attr_endurance_mod" value="0"> <button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{endurance_mod})d6>?{Target DC|2}"></button></label>
						<label>Wrestling <input type="checkbox" name="attr_wrestling_rank_1"> <input type="checkbox" name="attr_wrestling_rank_2"> <input type="hidden" name="attr_wrestling_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{wrestling_mod})d6>?{Target DC|2}"></button> </label>
						<label>Heavy Weapons <input type="checkbox" name="attr_heavy_weapons_rank_1"> <input type="checkbox" name="attr_heavy_weapons_rank_2"><input type="hidden" name="attr_heavy_weapons_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{heavy_weapons_mod})d6>?{Target DC|2}"></button></label>
						<label>Melee Weapons <input type="checkbox" name="attr_melee_weapons_rank_1"> <input type="checkbox" name="attr_melee_weapons_rank_2"><input type="hidden" name="attr_melee_weapons_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{melee_weapons_mod})d6>?{Target DC|2}"></button> </label>
						<label>Jumping <input type="checkbox" name="attr_jumping_rank_1"> <input type="checkbox" name="attr_jumping_rank_2"><input type="hidden" name="attr_jumping_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{jumping_mod})d6>?{Target DC|2}"></button></label>
						<label>Revolvers <input type="checkbox" name="attr_revolvers_rank_1"> <input type="checkbox" name="attr_revolvers_rank_2"><input type="hidden" name="attr_revolvers_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{revolvers_mod})d6>?{Target DC|2}"></button></label>
						<label>Strength <input type="checkbox" name="attr_strength_rank_1"> <input type="checkbox" name="attr_strength_rank_2"><input type="hidden" name="attr_strength_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{brawn}+@{strength_mod})d6>?{Target DC|2}"></button></label>
					</div>
				</div>
				<div class="attribute">
					<h2>Agility: <input type="number" name="attr_agility" value="0" /></h2>
					<label>Acrobatics <input type="checkbox" name="attr_acrobatics_rank_1"> <input type="checkbox" name="attr_acrobatics_rank_2"><input type="hidden" name="attr_acrobatics_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{acrobatics_mod})d6>?{Target DC|2}"></button></label>
					<label>Balance <input type="checkbox" name="attr_balance_rank_1"> <input type="checkbox" name="attr_balance_rank_2"><input type="hidden" name="attr_balance_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{balance_mod})d6>?{Target DC|2}"></button></label>
					<label>Light Pistols <input type="checkbox" name="attr_light_pistols_rank_1"> <input type="checkbox" name="attr_light_pistols_rank_2"><input type="hidden" value="0" name="attr_light_pistol_mod"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{acrobatics_mod})d6>?{Target DC|2}"></button></label>
					<label>Revolvers <input type="checkbox" name="attr_agility_revolver_rank_1"> <input type="checkbox" name="attr_agility_revolver_rank_2"><input type="hidden" value="0" name="attr_agility_revolver_mod"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{agility_revolver_mod})d6>?{Target DC|2}"></button></label>
					<label>Submachine Guns <input type="checkbox" name="attr_submachine_rank_1"> <input type="checkbox" name="attr_submachine_rank_2"><input type="hidden" value="0" name="attr_submachine_mod"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{submachine_mod})d6>?{Target DC|2}"></button></label>
					<label>Light Melee Weapons <input type="checkbox" name="attr_light_melee_weapons_rank_1"> <input type="checkbox" name="attr_light_melee_weapons_rank_2" value="0"><input type="hidden" name="attr_light_melee_mod"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{light_melee_mod})d6>?{Target DC|2}"></button></label>
					<label>Sneak <input type="checkbox" name="attr_sneak_rank_1"> <input type="checkbox" name="attr_sneak_rank_2"><input type="hidden" name="attr_sneak_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{sneak_mod})d6>?{Target DC|2}"></button></label>
					<label>Piloting <input type="checkbox" name="attr_piloting_rank_1"> <input type="checkbox" name="attr_piloting_rank_2"><input type="hidden" name="attr_piloting_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{agility}+@{piloting_mod})d6>?{Target DC|2}"></button></label>
				</div>
				<div class="attribute">
					<h2>Diligence: <input type="number" name="attr_diligence" value="0" /></h2>
					<label>Perception <input type="checkbox" name="attr_perception_rank_1"> <input type="checkbox" name="attr_perception_rank_2"><input type="hidden" name="attr_perception_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{perception_mod})d6>?{Target DC|2}"></button></label>
					<label>First Aid <input type="checkbox" name="attr_first_aid_rank_1"> <input type="checkbox" name="attr_first_aid_rank_2"><input type="hidden" name="attr_first_aid_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{first_aid_mod})d6>?{Target DC|2}"></button></label>
					<label>Insight <input type="checkbox" name="attr_insight_rank_1"> <input type="checkbox" name="attr_insight_rank_2"><input type="hidden" name="attr_insight_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{insight_mod})d6>?{Target DC|2}"></button></label>
					<label>Tracking <input type="checkbox" name="attr_tracking_rank_1"> <input type="checkbox" name="attr_tracking_rank_2"><input type="hidden" name="attr_tracking_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{tracking_mod})d6>?{Target DC|2}"></button></label>
					<label>Arcana <input type="checkbox" name="attr_arcana_rank_1"> <input type="checkbox" name="attr_arcana_rank_2"><input type="hidden" name="attr_arcana_mod" value="0"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{arcana_mod})d6>?{Target DC|2}"></button></label>
					<label>Piloting <input type="checkbox" name="attr_diligence_piloting_rank_1"> <input type="checkbox" name="attr_diligence_piloting_rank_2"><input type="hidden" value="0" name="attr_diligence_piloting_mod"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{diligence_piloting_mod})d6>?{Target DC|2}"></button></label>
					<label>Smart Weapons <input type="checkbox" name="attr_smart_weapons_rank_1"> <input type="checkbox" name="attr_smart_weapons_rank_2"><input type="hidden" value="0" name="attr_smart_weapons_mod"><button type="roll" value="/roll (?{Specialisation | No,0 &#124; Yes,2  &#125;+@{diligence}+@{smart_weapons_mod})d6>?{Target DC|2}"></button></label>
				</div>
			</div>
			<div class="ass">
				<div class="attribute">
					<h2>Appeal: <input type="number" name="attr_appeal" value="0" /></h2>
					<label>Persuasion <input type="checkbox" name="attr_persuasion_rank_1"> <input type="checkbox" name="attr_persuasion_rank_2"></label>
					<label>Performance <input type="checkbox" name="attr_performance_rank_1"> <input type="checkbox" name="attr_performance_rank_2"></label>
				</div>
				<div class="attribute">	
					<h2>Smarts: <input type="number" name="attr_smarts" value="0" /></h2>
				</div>
				<div class="attribute">
					<h2>Spellcasting: <input type="number" name="attr_spellcasting" value="0" /></h2>
				</div>
			</div>
			
		</div>
	
		<div class="body">
			<div class="body-top">
				<label>dummy</label>
			</div>
			<div class="body-bot">
				
				
			</div>
		</div>
	</div>
	
	<div class="sheet-inventory">
		<div class="inventory">
			<!--<img class="inventory-image" src="https://i.pinimg.com/564x/bf/8c/2a/bf8c2a35473ceaf53f728f2b79f65104.jpg">-->
			
			<div class="inventory-table">				
				<label style="grid-row: 1; grid-column: 1;">Inventory Name</label>
				<label style="grid-row: 1; grid-column: 2;">Slot</label>
				<label style="grid-row: 1; grid-column: 3;">Rarity</label>
				<div style="grid-row: 2; grid-column: 1/span 3; ">
					<fieldset class="repeating_attacks" >
						<input type="text" name="attr_inventory_name" style="width: 50px; grid-column: 1;"/>
						<input type="number" name="attr_slot" style="grid-column: 2;"/>
						<input type="text" name="attr_rarity" style="width: 100px; grid-column: 3;"/>
					</fieldset>
				</div>

			</div>
		</div>
	</div>
	<div class="sheet-attacks">
		<div class="top-row">
			<label>Initative<button type="roll" value="/r (@{diligence} + @{smarts})d6" name="roll_Iniative"></button></label>
			<label>Movement:<input type="number" value="0" name="attr_movement" /></label> 
		</div>
		<div class="top-row"> 
			<label>Armour Rating: <input type="number" value="10" name="attr_armour_rating"></label>
			<label>Energy Resistance: <input type="number" name="attr_energy_resistance" value="10" /></label> 
		</div>
		<div class="top-row">
			<label>Hit Points: <input type="number" name="attr_hitpoints" value="20"></label>
			<label>Fate Points: <input type="number" name="attr_fate_points" value="0"></label>
		</div>
		<div class="attacks">
			<div style="grid-row: 1; grid-column: span 4; text-align: center;"><h3>Attacks</h3></div>

			<div class="attacks-table-header">
				<label class="weapon-header">Weapon</label>
				<label class="range-header">Range</label>
				<label class="damage-header">Damage</label>
				<label class="ammunition-header">Ammo</label>
			</div>
			<fieldset class="repeating_weapons">
				<input type="text" name="attr_weapon_name" class="attacks-weapon">
				<input type="text" name="attr_weapon_range" class="attacks-range">
				<input type="number" name="attr_weapon_damage" class="attacks-damage">
				<input type="number" name="attr_weapon_ammunition" class="attacks-ammunition">
			</fieldset>
		</div>
	</div>
</div>
<!--SCRIPTS-->

<!--Change tab switch-->
<script type="text/worker">
    const buttonlist = ["attributes","inventory","attacks"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button
            });
        });
    });
</script>

<!--script to adjust climbing_skill based off on trained checkbox  Did I mention fuck js?-->
<script type="text/worker">
	const checkboxList = ["climbing_rank_1", "climbing_rank_2"];
	const hiddenField = "climbing_mod";
	console.log("cunt");
	checkboxList.forEach(checkbox => {
		on(`change:${checkbox}`, function() {
			
			console.log(`cunty cunt cunt ${checkbox}`);

			getAttrs([checkbox, hiddenField], function(values) {
				
				let newValue = parseInt(values[hiddenField]);

				console.log(newValue);
				if(values[checkbox] === 'on'){
					newValue += 2;
					console.log(newValue);
				}else{
					newValue -= 2;
					console.log(newValue);
				}

				setAttrs({
					[hiddenField]: newValue
					
				});
			});
		});
	});
	
</script>

<!--Endurance-->
<script type="text/worker">
	const checkboxList = ["endurance_rank_1", "endurance_rank_2"];
	const hiddenField = "endurance_mod";
	console.log("cunt");
	checkboxList.forEach(checkbox => {
		on(`change:${checkbox}`, function() {
			
			console.log(`cunty cunt cunt ${checkbox}`);

			getAttrs([checkbox, hiddenField], function(values) {
				
				let newValue = parseInt(values[hiddenField]);

				console.log(newValue);
				if(values[checkbox] === 'on'){
					newValue += 2;
					console.log(newValue);
				}else{
					newValue -= 2;
					console.log(newValue);
				}

				setAttrs({
					[hiddenField]: newValue
					
				});
			});
		});
	});
	
</script>
<!--script to change attributes of races on the sheet, if Jooooooh adds more might can it and have people go manual-->
<script type="text/worker">
	let race_modifiers = {
		"Human": {brawn: 0, agility: 0, diligence: 0, appeal: 1, smarts: 0, spellcasting: 0, movement: 6},
		"Dwarf": {brawn: 1, agility: 0, diligence: 0, appeal: 0, smarts: 1, spellcasting: 0, movement: 5},
		"Jaraquenai": {brawn: 1, agility: 0, diligence: 1, appeal: 0, smarts: 0, spellcasting: 0, movement: 6},
		"Jaramenat": {brawn: 0, agility: 0, diligence: 1, appeal: 0, smarts: 1, spellcasting: 0, movement: 6},
		"Elf": {brawn: 0, agility: 1, diligence: 1, appeal: 0, smarts: 0, spellcasting: 0, movement: 7},
		"Vermere": {brawn: 0, agility: 1, diligence: 0, appeal: 0, smarts: 1, spellcasting: 0, movement: 5},
		"Rendara": {brawn: 0, agility: 0, diligence: 0, appeal: 1, smarts: 0, spellcasting: 0, movement: 6},
		"Algorian": {brawn: 0, agility: 0, diligence: 0, appeal: 0, smarts: 1, spellcasting: 0, movement: 6},
		"Cthonian": {brawn: 1, agility: 1, diligence: 0, appeal: 0, smarts: 0, spellcasting: 0, movement: 6}
	};

	let previous_race = null;

	on("change:race", function() {
		getAttrs(["race"].concat(Object.keys(race_modifiers["Human"])), function(values){

			console.log(values.race);

			let updates = {};

			if(previous_race){
				for (let temp in race_modifiers[previous_race]){
					updates[temp] = (parseInt(values[temp]) - race_modifiers[previous_race][temp]).toString();
				}
			}

			for(let temp in race_modifiers[values.race]){
				updates[temp] = (parseInt(updates[temp] || values[temp]) + race_modifiers[values.race][temp]).toString();
			}

			setAttrs(updates);

			previous_race = values.race;
		});
	});
</script>